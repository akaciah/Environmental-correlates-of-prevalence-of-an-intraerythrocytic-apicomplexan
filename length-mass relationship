Install Packages
```{r}
library(FSA)
library(dplyr)
library(knitr)
library(xtable)
```

Read in Data
```{r}
relationship <- read.csv("lengthweight.csv",header=TRUE)
```

View data
```{r}
str(relationship)
```
Create summary table of data
```{r}
t <- relationship %>%
    group_by(Health) %>%
summarize(count = n(),
              MeanWeight = mean(Mass), MeanLength = mean(Length),
              StDevWeight = sd(Mass), StDevLength = sd(Length))
t
```


```{r kable, results = 'asis'}
kable(head(t), digits = 2)

```

```{r}
library(xtable)
print(xtable(head(t)), type = "html")
```

Create a subset containing just the length and weight variables
```{r}
lengthweight <- Subset(relationship,!is.na(Mass) & !is.na(Length))
```

Create Log(Length) and Log(Weight) variable
```{r}
lengthweight$logL <- log(lengthweight$Length)
lengthweight$logM <- log(lengthweight$Mass)
```

View changes
```{r}
str(lengthweight)

```

Fit transformed model with Linear Model 
```{r}
lm1 <- lm(logM~logL,data=lengthweight)
```

View data and model fit
```{r}
fitPlot(lm1,xlab="log Total Length (mm)",ylab="log Weight (g)",main="Linear Model of S. adustus")
```

Summary of model fit
```{r}
summary(lm1)
```

A test of whether the fish in a population exhibit isometric growth or not can be obtained by noting that
b is the estimated slope from fitting the transformed length-weight model. The slope is generically labeled
with ?? such that the test for allometry can be translated into the following statistical hypotheses:
 H0 : B = 3  H0 : "Isometric growth"
 HA : B not = 3 HA : "Allometric growth"


Determine whether damselfish are exhibiting allometric growth
```{r}
hoCoef(lm1,2,3)

confint(lm1)
```

Correct back transformation bias
```{r}
syx <- summary(lm1)$sigma
( cf <- exp((syx^2)/2) ) # this is the bias correction factor
```

Predict mean log weight
```{r}
( pred.log <- predict(lm1,data.frame(logL=log(100)),interval="c") )
```

Use predicted mean log weight to form a biased predicted mean weight
```{r}
( bias.pred.orig <- exp(pred.log) ) # biased prediction on original scale
```

Compute bias-corrected back-transformed mean weight
```{r}
( pred.orig <- cf*bias.pred.orig ) # corrected prediction on original scale
```

Compare Length-Weight Relationships between groups via model
```{r}
lm2 <- lm(logM~logL*Health,data=lengthweight)
summary(lm2)
```

Analyze model using ANOVA
```{r}
anova(lm2)

```

Plot comparison model
```{r}
fitPlot(lm2,xlab="log Fork Length (mm)",ylab="log Weight (g)",legend="topleft",main="Linear Model of S. adustus by Health Status")
```

```{r}
lm3 <- lm(logL~Health,data=lengthweight)
confint(lm3)
```
+
```{r}
result <- aov(logM~logL*Health,data=lengthweight)
result
